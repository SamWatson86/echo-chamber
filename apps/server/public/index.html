<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Echo Chamber</title>
    <link rel="stylesheet" href="/style.css?v=20260204g" />
  </head>
  <body>
    <div class="app">
      <header class="hero">
        <div>
          <div class="hero-title-row">
            <h1 id="server-name">Echo Chamber</h1>
            <span id="env-badge" class="env-badge hidden" aria-live="polite"></span>
            <div id="room-list" class="room-list hidden" aria-label="Active rooms"></div>
          </div>
          <p>Host a private room for mic + screen sharing.</p>
        </div>
        <div class="status-area">
          <div class="status" id="status">Offline</div>
          <div class="status-actions">
            <button id="leave-room" type="button" class="ghost">Leave Room</button>
            <button id="open-settings" type="button" class="ghost hidden">Settings</button>
            <button id="open-admin" type="button" class="ghost hidden">Admin</button>
            <button id="create-room" type="button" class="ghost">Create Room</button>
            <button id="restart-app" type="button" class="ghost hidden">Restart App</button>
          </div>
        </div>
      </header>

      <main>
        <section id="login" class="panel">
          <h2>Enter room password</h2>
          <form id="login-form">
            <label>
              Password
              <input type="password" id="password" autocomplete="current-password" required />
            </label>
            <label class="remember-toggle">
              <input type="checkbox" id="remember-password" />
              Remember this device
            </label>
            <button type="submit">Unlock</button>
          </form>
          <p class="hint">Ask the host for the password.</p>
        </section>

        <section id="lobby" class="panel hidden">
          <h2>Join a room</h2>
          <form id="join-form">
            <label>
              Display name
              <input type="text" id="displayName" maxlength="64" required />
            </label>
            <input type="hidden" id="roomName" value="main" />
            <button type="submit">Join Room</button>
          </form>
        </section>

        <section id="call" class="panel hidden">
          <div class="room-main">
            <div class="grid-header">
              <h3>Screens</h3>
            </div>
            <div id="screen-grid" class="media-grid"></div>
            <div id="camera-lobby" class="camera-lobby hidden">
            <div class="camera-lobby-header">
              <h3>Camera Lobby</h3>
              <div class="camera-lobby-actions">
                <div class="camera-lobby-controls">
                  <button id="toggle-mic-lobby" type="button" class="ghost icon-button"></button>
                  <button id="toggle-camera-lobby" type="button" class="ghost icon-button"></button>
                </div>
                <button id="toggle-room-audio-lobby" type="button" class="ghost">Mute All</button>
                <button id="close-camera-lobby" type="button" class="ghost">Back</button>
              </div>
            </div>
              <div id="camera-grid" class="media-grid"></div>
              <div id="camera-lobby-empty" class="hint">No active cameras yet.</div>
            </div>
            <div id="soundboard" class="soundboard hidden" role="dialog" aria-label="Soundboard">
              <div class="soundboard-header">
                <h3>Soundboard</h3>
                <div class="soundboard-actions">
                  <button
                    id="toggle-soundboard-volume"
                    type="button"
                    class="ghost"
                    aria-expanded="false"
                    aria-controls="soundboard-volume-panel"
                  >
                    Soundboard Volume
                  </button>
                  <button id="close-soundboard" type="button" class="ghost">Back</button>
                </div>
              </div>
              <div id="soundboard-volume-panel" class="soundboard-volume hidden" aria-hidden="true">
                <div class="soundboard-volume-row">
                  <input id="soundboard-volume" type="range" min="0" max="100" value="100" />
                  <span id="soundboard-volume-value" class="soundboard-volume-value">100%</span>
                </div>
              </div>
              <div class="soundboard-search">
                <input id="sound-search" type="text" placeholder="Find the perfect sound" />
              </div>
              <div id="soundboard-grid" class="soundboard-grid"></div>
              <div class="soundboard-upload">
                <div class="soundboard-upload-row">
                  <input id="sound-name" type="text" maxlength="60" placeholder="Name (e.g. Hooray!)" />
                  <button id="sound-upload-button" type="button" class="ghost">Upload</button>
                  <button id="sound-cancel-edit" type="button" class="ghost hidden">Cancel</button>
                  <label class="sound-file">
                    <input id="sound-file" type="file" accept="audio/*" />
                    <span id="sound-file-label">Select audio</span>
                  </label>
                </div>
                <div class="soundboard-upload-volume">
                  <div class="soundboard-upload-volume-label">Clip volume</div>
                  <input id="sound-clip-volume" type="range" min="0" max="200" value="100" />
                  <div id="sound-clip-volume-value" class="soundboard-volume-value">100%</div>
                </div>
                <div class="soundboard-icons">
                  <div class="soundboard-icons-label">Pick an icon</div>
                  <div id="soundboard-icon-grid" class="soundboard-icon-grid"></div>
                </div>
                <div id="soundboard-hint" class="hint"></div>
              </div>
            </div>
            <div id="diagnostics" class="diagnostics is-collapsed">
              <div class="diagnostics-header">
                <h4>Stream diagnostics</h4>
                <div class="diagnostics-actions">
                  <button id="toggle-diagnostics" type="button" class="ghost">Diagnostics</button>
                  <button id="close-diagnostics" type="button" class="ghost">Close</button>
                </div>
              </div>
              <div id="diagnostics-body" class="diagnostics-body"></div>
            </div>
            <div class="room-controls">
              <div class="share">
                <button id="copy-link" type="button" class="ghost">Copy Room Link</button>
                <span id="share-status" class="hint"></span>
              </div>
            </div>
            <div class="local">
              <h3>Local preview</h3>
              <div class="local-previews">
                <div class="local-card">
                  <div class="local-label">Screen</div>
                  <video id="local-screen" autoplay playsinline muted></video>
                </div>
                <div class="local-card">
                  <div class="local-label">Camera</div>
                  <video id="local-camera" autoplay playsinline muted></video>
                </div>
              </div>
              <div class="local-meta">
                <span id="local-mic">Mic: off</span>
                <span id="local-camera-status">Camera: off</span>
                <span id="local-screen-status">Screen: off</span>
              </div>
            </div>
          </div>
          <aside class="room-sidebar">
            <div class="sidebar-header">
              <div class="sidebar-title-row">
                <h3>Active users</h3>
                <div class="sidebar-actions">
                  <button id="open-soundboard" type="button" class="ghost">Soundboard</button>
                  <button id="open-camera-lobby" type="button" class="ghost">Camera Lobby</button>
                </div>
              </div>
              <button id="toggle-room-audio" type="button" class="ghost">Mute All</button>
              <div class="self-controls-staging hidden">
                <button id="toggle-all" type="button">Enable All</button>
                <button id="toggle-mic" type="button">Enable Mic</button>
                <button id="toggle-camera" type="button">Enable Camera</button>
                <button id="toggle-screen" type="button">Share Screen</button>
              </div>
            </div>
            <div id="user-list" class="user-list"></div>
          </aside>
          <div id="settings-panel" class="settings-panel hidden" role="dialog" aria-label="Settings">
            <div class="settings-card">
              <div class="settings-header">
                <h3>Settings</h3>
                <button id="close-settings" type="button" class="ghost">Close</button>
              </div>
              <div class="settings-body">
                <label class="avatar-upload">
                  <span>Your icon / GIF</span>
                  <button id="avatar-button" type="button" class="ghost">Choose Avatar</button>
                  <input id="avatar-input" class="avatar-input" type="file" accept="image/*,image/gif" />
                </label>
                <div class="device-controls">
                  <label>
                    Microphone
                    <select id="mic-select">
                      <option value="">System default</option>
                    </select>
                  </label>
                  <label>
                    Camera
                    <select id="camera-select">
                      <option value="">System default</option>
                    </select>
                  </label>
                  <label>
                    Output
                    <select id="speaker-select">
                      <option value="">System default</option>
                    </select>
                  </label>
                  <label>
                    Screen quality
                    <select id="screen-quality">
                      <option value="native" selected>Native (source resolution)</option>
                      <option value="high">High (1080p / 30 fps)</option>
                      <option value="medium">Medium (900p / 20 fps)</option>
                      <option value="low">Low (720p / 15 fps)</option>
                    </select>
                  </label>
                </div>
              </div>
            </div>
          </div>
          <div id="admin-panel" class="settings-panel hidden" role="dialog" aria-label="Admin">
            <div class="settings-card admin-card">
              <div class="settings-header">
                <h3>Admin</h3>
                <div class="settings-header-actions">
                  <button id="admin-refresh" type="button" class="ghost hidden">Refresh</button>
                  <button id="admin-close" type="button" class="ghost">Close</button>
                </div>
              </div>
              <div class="settings-body admin-body">
                <div id="admin-login" class="admin-login">
                  <label>
                    Admin password
                    <input type="password" id="admin-password" autocomplete="current-password" />
                  </label>
                  <button id="admin-login-button" type="button">Unlock Admin</button>
                  <p id="admin-login-hint" class="hint"></p>
                </div>
                <div id="admin-content" class="admin-content hidden">
                  <div class="admin-actions">
                    <button id="admin-restart" type="button" class="ghost">Soft Restart</button>
                    <button id="admin-logout" type="button" class="ghost">Sign Out</button>
                  </div>
                  <div class="admin-status">
                    <div class="admin-stat">
                      <span>Uptime</span>
                      <strong id="admin-uptime">-</strong>
                    </div>
                    <div class="admin-stat">
                      <span>Rooms</span>
                      <strong id="admin-room-count">0</strong>
                    </div>
                    <div class="admin-stat">
                      <span>Peers</span>
                      <strong id="admin-peer-count">0</strong>
                    </div>
                  </div>
                  <div class="admin-rooms">
                    <h4>Active rooms</h4>
                    <div id="admin-room-list" class="admin-room-list"></div>
                  </div>
                  <div class="admin-logs">
                    <div class="admin-logs-header">
                      <h4>Recent logs</h4>
                      <button id="admin-refresh-logs" type="button" class="ghost">Refresh logs</button>
                    </div>
                    <pre id="admin-logs-output" class="admin-logs-output"></pre>
                  </div>
                  <p class="hint">Full server restart is available from the Echo Chamber tray app.</p>
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>

      <footer>
        <div id="message" class="message"></div>
      </footer>
    </div>

    <script type="module" src="/app.js?v=20260204g"></script>
  </body>
</html>
